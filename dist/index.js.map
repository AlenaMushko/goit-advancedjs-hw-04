{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY =\n  import.meta.env.VITE_PIXABAY_API_KEY || \"52943742-ef4895d686f7f0b07a1c6f293\";\nconst BASE_URL =\n  import.meta.env.VITE_PIXABAY_BASE_URL || \"https://pixabay.com/api/\";\n\nexport async function searchImages(query, perPage, page = 1) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    page: page,\n    per_page: perPage,\n  };\n\n  try {\n    const { data } = await axios.get(BASE_URL, { params });\n    return data;\n  } catch (error) {\n    throw new Error(`Failed to fetch images: ${error.message}`);\n  }\n}\n","export function renderGallery(images, galleryEl, append = false) {\n  const galleryHTML = images\n    .map(\n      image => `\n    <li class=\"gallery-item\">\n      <a href=\"${image.largeImageURL}\" class=\"gallery-link\">\n        <img \n          src=\"${image.webformatURL}\" \n          alt=\"${image.tags}\" \n          loading=\"lazy\"\n          class=\"gallery-image\"\n        />\n        <div class=\"gallery-info\">\n          <p class=\"info-item\">\n            <b>Likes</b> <span class=\"info-item-value\">${image.likes}</span>\n          </p>\n          <p class=\"info-item\">\n            <b>Views</b> <span class=\"info-item-value\">${image.views}</span>\n          </p>\n          <p class=\"info-item\">\n            <b>Comments</b> <span class=\"info-item-value\">${image.comments}</span>\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads</b> <span class=\"info-item-value\">${image.downloads}</span>\n          </p>\n        </div>\n      </a>\n    </li>\n  `\n    )\n    .join('');\n\n  if (append) {\n    galleryEl.insertAdjacentHTML('beforeend', galleryHTML);\n  } else {\n    galleryEl.innerHTML = galleryHTML;\n  }\n}\n\nexport function clearGallery(galleryEl) {\n  galleryEl.innerHTML = '';\n}\n\nexport function showLoader(loaderEl) {\n  loaderEl.classList.remove('is-hidden');\n}\n\nexport function hideLoader(loaderEl) {\n  loaderEl.classList.add('is-hidden');\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { searchImages } from \"./js/pixabay-api.js\";\nimport {\n  renderGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n} from \"./js/render-functions.js\";\n\nconst searchForm = document.querySelector(\".form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".spinner\");\nconst loadMoreContainer = document.querySelector(\"#load-more-container\");\nconst loadMoreButton = document.querySelector(\"#load-more-button\");\n\nlet lightbox = null;\nlet currentQuery = \"\";\nlet currentPage = 1;\nlet totalHits = 0;\nlet totalPages = 0;\n\nexport const PER_PAGE = 15;\n\nsearchForm.addEventListener(\"submit\", async (e) => {\n  e.preventDefault();\n\n  const searchQuery = searchForm.searchQuery.value.trim();\n\n  if (!searchQuery) {\n    iziToast.warning({\n      title: \"Warning\",\n      message: \"Please enter at least 1 character\",\n      position: \"topRight\",\n    });\n    return;\n  }\n\n  currentQuery = searchQuery;\n  currentPage = 1;\n  totalHits = 0;\n  totalPages = 0;\n\n  clearGallery(gallery);\n  hideLoadMoreButton();\n\n  showLoader(loader);\n\n  try {\n    const data = await searchImages(searchQuery, PER_PAGE, currentPage);\n\n    hideLoader(loader);\n\n    if (data.hits && data.hits.length > 0) {\n      totalHits = data.totalHits;\n      totalPages = Math.ceil(totalHits / PER_PAGE);\n\n      renderGallery(data.hits, gallery);\n\n      if (lightbox) {\n        lightbox.refresh();\n      } else {\n        lightbox = new SimpleLightbox(\".gallery a\", {\n          captionsData: \"alt\",\n          captionDelay: 250,\n        });\n      }\n\n      if (currentPage < totalPages) {\n        showLoadMoreButton();\n      }\n    } else {\n      iziToast.error({\n        message:\n          \"Sorry, there are no images matching your search query. Please try again!\",\n        position: \"topRight\",\n      });\n    }\n  } catch (error) {\n    hideLoader(loader);\n    iziToast.error({\n      message: `An error occurred: ${error.message}`,\n      position: \"topRight\",\n    });\n  }\n});\n\nfunction showLoadMoreButton() {\n  loadMoreContainer.classList.remove(\"is-hidden\");\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreContainer.classList.add(\"is-hidden\");\n}\n\nloadMoreButton.addEventListener(\"click\", async () => {\n  if (!currentQuery) return;\n\n  currentPage += 1;\n  showLoader(loader);\n\n  try {\n    const data = await searchImages(currentQuery, PER_PAGE, currentPage);\n    hideLoader(loader);\n\n    renderGallery(data.hits, gallery, true);\n\n    if (lightbox) {\n      lightbox.refresh();\n    }\n\n    setTimeout(() => {\n      const galleryItems = gallery.querySelectorAll(\".gallery-item\");\n      if (galleryItems.length > 0) {\n        const firstNewItem = galleryItems[galleryItems.length - PER_PAGE];\n        if (firstNewItem) {\n          const cardHeight = firstNewItem.getBoundingClientRect().height;\n          window.scrollBy({\n            top: cardHeight * 2,\n            behavior: \"smooth\",\n          });\n        }\n      }\n    }, 100);\n\n    if (currentPage >= totalPages) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    }\n  } catch (error) {\n    hideLoader(loader);\n    iziToast.error({\n      message: `An error occurred: ${error.message}`,\n      position: \"topRight\",\n    });\n  }\n});\n"],"names":["API_KEY","BASE_URL","searchImages","query","perPage","page","params","data","axios","error","renderGallery","images","galleryEl","append","galleryHTML","image","clearGallery","showLoader","loaderEl","hideLoader","searchForm","gallery","loader","loadMoreContainer","loadMoreButton","lightbox","currentQuery","currentPage","totalHits","totalPages","PER_PAGE","e","searchQuery","iziToast","hideLoadMoreButton","SimpleLightbox","showLoadMoreButton","galleryItems","firstNewItem","cardHeight"],"mappings":"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"}